<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Introducing Charm; Death to Charm &mdash; Alex Clark&#39;s Blog</title>
    
    <link rel="stylesheet" href="../../../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/bootswatch-3.3.4/readable/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../../../_static/bootstrap-3.3.4/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../../../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
    <link rel="top" title="Alex Clark&#39;s Blog" href="../../../../" />
  
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  
  <link rel="alternate" type="application/atom+xml"  href="../../../../blog/atom.xml" title="Alex Clark's Blog">
  
  
  <link href="True" rel="stylesheet">
  
  <style type="text/css">
    ul.ablog-archive {list-style: none; overflow: auto; margin-left: 0px}
    ul.ablog-archive li {float: left; margin-right: 5px; font-size: 80%}
    ul.postlist a {font-style: italic;}
    ul.postlist-style-disc {list-style-type: disc;}
    ul.postlist-style-none {list-style-type: none;}
    ul.postlist-style-circle {list-style-type: circle;}
  </style>

  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-inverse navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../../../">
          Alex Clark&#39;s Blog</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="http://aclark.net">Home</a></li>
                <li><a href="https://www.facebook.com/aclark4life">Facebook</a></li>
                <li><a href="https://github.com/aclark4life">GitHub</a></li>
                <li><a href="https://gratipay.com/aclark4life">Gratipay</a></li>
                <li><a href="https://www.linkedin.com/in/aclark4life">LinkedIn</a></li>
                <li><a href="https://twitter.com/aclark4life">Twitter</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../../../">Pages <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../now/">What I&#8217;m doing now</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../feeds/">Feeds</a></li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../../../search/" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary">
  
  
  <h2>
  
  <i class="fa fa-calendar"></i>
    Mar 29, 2011
  
  </h2>

  <ul>
    

  

  

  

  
  <li><i class="fa-fw fa fa-folder-open"></i>
    
      
      <a href="../../../../blog/category/plone/">Plone</a>
      
    </li>
  

  
  
  <li>
    <script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'aclark-blog'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
    var s = document.createElement('script'); s.async = true;
    s.type = 'text/javascript';
    s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
    </script>
    <i class="fa-fw fa fa-comments"></i>
    <a href="#disqus_thread" data-disqus-identifier="/2011/03/29/introducing-charm-death-to-charm/index/"> </a>
  </li>
  
  </ul>



  <h3><a href="../../../../blog/">Recent Posts</a></h3>
  <ul>
    
    
      <li><a href="../../../../2016/04/03/yup-this-blog-is-now-powered-by-ablog/">Apr 03 - Yup, this blog is now powered by ABlog</a></li>
    
      <li><a href="../../../../2016/02/21/updated-django-website/">Feb 21 - Updated Django Website</a></li>
    
      <li><a href="../../../../2015/10/10/plock-0-5-0-is-out/">Oct 10 - Plock 0-5-0 is out</a></li>
    
      <li><a href="../../../../2015/10/07/dc-python-jobs/">Oct 07 - DC Python Jobs</a></li>
    
      <li><a href="../../../../2015/10/05/i-reinstalled-again/">Oct 05 - I Reinstalled Again</a></li>
    
  </ul>

  <h3><a href="../../../../blog/category/">Categories</a></h3>
  <ul>
  
    
    <li><a href="../../../../blog/category/buildout/">Buildout (33)</a></li>
    
  
    
    <li><a href="../../../../blog/category/django/">Django (5)</a></li>
    
  
    
    <li><a href="../../../../blog/category/misc/">Misc (22)</a></li>
    
  
    
    <li><a href="../../../../blog/category/mozilla/">Mozilla (2)</a></li>
    
  
    
    <li><a href="../../../../blog/category/music/">Music (1)</a></li>
    
  
    
    <li><a href="../../../../blog/category/pillow/">Pillow (16)</a></li>
    
  
    
    <li><a href="../../../../blog/category/plone/">Plone (79)</a></li>
    
  
    
    <li><a href="../../../../blog/category/pyramid/">Pyramid (6)</a></li>
    
  
    
    <li><a href="../../../../blog/category/python/">Python (61)</a></li>
    
  
    
    <li><a href="../../../../blog/category/zope/">Zope (6)</a></li>
    
  
  </ul>

  <h3><a href="../../../../blog/archive/">Archives</a></h3>
  <ul>
  
    
    <li><a href="../../../../blog/2016/">2016 (2)</a></li>
    
  
    
    <li><a href="../../../../blog/2015/">2015 (13)</a></li>
    
  
    
    <li><a href="../../../../blog/2014/">2014 (11)</a></li>
    
  
    
    <li><a href="../../../../blog/2013/">2013 (21)</a></li>
    
  
    
    <li><a href="../../../../blog/2012/">2012 (35)</a></li>
    
  
    
    <li><a href="../../../../blog/2011/">2011 (26)</a></li>
    
  
    
    <li><a href="../../../../blog/2010/">2010 (9)</a></li>
    
  
    
    <li><a href="../../../../blog/2009/">2009 (7)</a></li>
    
  
    
    <li><a href="../../../../blog/2008/">2008 (19)</a></li>
    
  
    
    <li><a href="../../../../blog/2007/">2007 (8)</a></li>
    
  
  </ul>

<form action="../../../../search/" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
    <div class="col-md-9 content">
      
  <div class="section" id="introducing-charm-death-to-charm">
<h1>Introducing Charm; Death to Charm<a class="headerlink" href="#introducing-charm-death-to-charm" title="Permalink to this headline">¶</a></h1>
<p><strong>A long time ago (several years ago, or more) one of my first Plone jobs was importing content from the file system.</strong></p>
<p>A long time ago (several years ago, or more) one of my first Plone jobs was importing content from the file system (put there by another CMS) to a client&#8217;s Plone 2.5 website (see: <a class="reference external" href="http://blip.tv/file/761624/">http://blip.tv/file/761624/</a>).</p>
<p>Some time later (last year or so) the client decided they wanted to scoop up even more content from the file system (we only grabbed the last few years prior to launch!)</p>
<p>Unfortunately, the old migration code was truly a horror. So I&#8217;ve been having a hard time making myself run it again (I was just learning Python at the time.)</p>
<div class="section" id="about-charm">
<h2>About charm<a class="headerlink" href="#about-charm" title="Permalink to this headline">¶</a></h2>
<p>This is where <em>charm</em> comes in; formerly <a class="reference external" href="http://pypi.python.org/pypi/mr.importer">mr.importer</a>, formerly <a class="reference external" href="http://pypi.python.org/pypi/parse2plone">parse2plone</a>. Get it? The third time is a… I had the &#8220;big idea&#8221; to rewrite, then open source the code I wrote for the client.  Unfortunately, the rewrite became a horror too.</p>
<p>First, it was not well received amongst the more reusable approaches based on <a class="reference external" href="http://pypi.python.org/pypi/collective.transmogrifier">collective.transmogrifier</a>, and rightfully so. While it was unpleasant to be told I was heading in the wrong direction, it was <strong>*even more*</strong> unpleasant to find out &#8220;they&#8221; were right.</p>
<p>Second, as &#8220;they&#8221; predicted, I got to the point where I couldn&#8217;t read or maintain it any more (and I <strong>*just*</strong> wrote it).</p>
<p>So, I decided to revert to a version which had much fewer configuration options, because making it configurable became a huge distraction. What&#8217;s left is:</p>
<ul class="simple">
<li>The code is &#8220;readable&#8221;, for some value of readable (PEP8/pyflakes compliant) and it&#8217;s in a single module: <a class="reference external" href="https://github.com/collective/charm/blob/master/charm.py">charm.py</a>.</li>
<li>The concept is &#8220;simple&#8221;, for some value of simple; it&#8217;s a recipe that creates a script for you, that you run via:</li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span></span>$ bin/plone run bin/charm /path/to/files
</pre></div>
</div>
<ul class="simple">
<li>The results are &#8220;impressive&#8221; for some value of impressive; it imports content from the file system into Plone:</li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span></span>2011-03-21 11:51:20,302 - charm - INFO - Imported 19 folders,
1 images, 20 pages, and 2 files.
</pre></div>
</div>
<ul class="simple">
<li>It won&#8217;t crash (!), for some value of &#8220;keeps going&#8221;; it tries to do try/except on operations more likely to fail&nbsp; e.g. create_parts (via &#8211;ignore-errors). This aims to ensure you at least get some content in your site post-execution.</li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span></span>$ bin/plone run bin/charm html --ignore-errors
...
2011-03-22 07:24:32,821 - charm - INFO - creating folder &#39;id&#39; inside
                          parent folder &#39;/Plone&#39;
2011-03-22 07:24:32,822 - charm - INFO - Keep going! Ignoring error
                          &#39;The id &quot;id&quot; is invalid - it is already in use.&#39;
</pre></div>
</div>
<ul class="simple">
<li>It has some tests, 34% coverage at the time of this writing:</li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span></span>619    34%   charm   (/Users/aclark/Developer/charm/charm.py)
</pre></div>
</div>
<ul class="simple">
<li>Has &#8220;cool&#8221; features, for some value of cool. Most notably, the &#8220;collapse&#8221; feature (AKA &#8220;slugify&#8221;):</li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span></span>$ bin/plone run bin/charm html --collapse
...
2011-03-22 07:13:28,673 - charm - INFO - path &#39;html/2011/01/01/test-collapse&#39;,
                          has subdirs &#39;&#39;, and files &#39;index.html&#39;
...
2011-03-22 07:13:28,693 - charm - INFO - object &#39;test-collapse-20110101.html&#39;
                          does not exist inside &#39;/Plone&#39;
2011-03-22 07:13:28,693 - charm - INFO - creating page &#39;test-collapse-20110101.html&#39;
                          inside parent folder &#39;/Plone&#39;
</pre></div>
</div>
<ul class="simple">
<li>And the &#8220;publish&#8221; feature to optionally publish content after creation:</li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span></span>$ bin/plone run bin/charm html --collapse --publish
...
2011-03-22 07:13:29,008 - charm - INFO - publishing page &#39;test-collapse-20110101.html&#39;
</pre></div>
</div>
<p>And a few more things, but as you can see we are quickly approaching the point where more functionality does not necessarily mean better software. It&#8217;s hard to build something complex AND make it easy to use, which is why I am moving on.</p>
</div>
<div class="section" id="charming-demo">
<h2>Charming demo<a class="headerlink" href="#charming-demo" title="Permalink to this headline">¶</a></h2>
<p>In writing this blog entry and releasing charm 1.0b4 I wanted to make sure to demonstrate how it works, so here is a screencast. This is how I envision content importing should work in Plone (or at least this is how I envision a &#8220;simple&#8221; way it could work.)</p>
</div>
<div class="section" id="after-charm">
<h2>After charm<a class="headerlink" href="#after-charm" title="Permalink to this headline">¶</a></h2>
<p>After I began writing <em>charm</em>, I began to collaborate with Dylan Jay on funnelweb and beyond (e.g. <a class="reference external" href="https://github.com/collective/mr.migrator">mr.migrator</a>). And I am now more determined than ever to write reusable code.</p>
</div>
</div>

  <div class="section">
  
    


<div class="section">
  <span style="float: left;">
  
  
  <a href="../../../02/16/cioppino-sprint-report/">
    <i class="fa fa-arrow-circle-left"></i>
    Cioppino Sprint Report
  </a>
  
  </span>
  <span>&nbsp;</span>
  <span style="float: right;">
  
  
  <a href="../../../04/15/collective-transmogrifier-without-plone/">
    Collective.transmogrifier Without Plone?
    <i class="fa fa-arrow-circle-right"></i>
  </a>
  </span>
  
</div>

  
  
    <div class="section">
    <h2>Comments</h2>
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_shortname = 'aclark-blog';
        var disqus_identifier = '/2011/03/29/introducing-charm-death-to-charm/';
        var disqus_title = 'Introducing Charm; Death to Charm';
        var disqus_url = 'http://blog.aclark.net/2011/03/29/introducing-charm-death-to-charm/';

        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </div>
  
  </div>

    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2016, Alex Clark.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.5.<br/>
    </p>
  </div>
</footer>
  </body>
</html>